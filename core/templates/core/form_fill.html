<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fill Form: {{ form.form_name }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .container { max-width: 700px; background-color: white; padding: 2rem; border-radius: 0.5rem; margin-top: 2rem; box-shadow: 0 0 15px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
    <main class="container">
        <h2 class="mb-4">{{ form.form_name }}</h2>
        <hr>

        <!-- The enctype is crucial for file uploads to work -->
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <!-- FULLY CORRECTED DYNAMIC RENDERER -->
            {% for field in form.fields %}
                <div class="mb-3">
                    <label for="{{ field.name|slugify }}" class="form-label fw-bold">{{ field.name }}</label>
                    
                    {% if field.type == "TEXTAREA" %}
                        <textarea name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required></textarea>
                    
                    {% elif field.type == "SELECT" %}
                        <select name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-select" required>
                            <option value="" disabled selected>-- Please choose an option --</option>
                            {% for option in field.options %}<option value="{{ option }}">{{ option }}</option>{% endfor %}
                        </select>
                    
                    {% elif field.type == "MULTISELECT" %}
                        <select name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-select" multiple required>
                            {% for option in field.options %}<option value="{{ option }}">{{ option }}</option>{% endfor %}
                        </select>
                        <small class="form-text text-muted">Hold Ctrl (or Cmd on Mac) to select multiple.</small>

                    {% elif field.type == "RADIO" %}
                        {% for option in field.options %}<div class="form-check">
                            <input class="form-check-input" type="radio" name="{{ field.name }}" id="{{ field.name|slugify }}-{{ forloop.counter }}" value="{{ option }}" required>
                            <label class="form-check-label" for="{{ field.name|slugify }}-{{ forloop.counter }}">{{ option }}</label>
                        </div>{% endfor %}

                    {% elif field.type == "CHECKBOX" %}
                        {% if field.options %} {# This is a checkbox group #}
                            {% for option in field.options %}<div class="form-check">
                                <input class="form-check-input" type="checkbox" name="{{ field.name }}" id="{{ field.name|slugify }}-{{ forloop.counter }}" value="{{ option }}">
                                <label class="form-check-label" for="{{ field.name|slugify }}-{{ forloop.counter }}">{{ option }}</label>
                            </div>{% endfor %}
                        {% else %} {# This is a single boolean checkbox #}
                            <div class="form-check"><input class="form-check-input" type="checkbox" name="{{ field.name }}" id="{{ field.name|slugify }}" value="true"></div>
                        {% endif %}

                    {% elif field.type == "INTEGER" %}
                        <input type="number" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>
                    {% elif field.type == "FLOAT" %}
                        <input type="number" step="any" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>
                    {% elif field.type == "DATE" %}
                        <input type="date" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>
                    {% elif field.type == "DATETIME" %}
                        <input type="datetime-local" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>
                    {% elif field.type == "EMAIL" %}
                        <input type="email" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>
                    {% elif field.type == "PHONE" %}
                        <input type="tel" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>
                    {% elif field.type == "PASSWORD" %}
                        <input type="password" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>
                    {% elif field.type == "URL" %}
                        <input type="url" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>
                    {% elif field.type == "FILE" %}
                        <input type="file" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>

                    {% else %} {# Default to text input for VARCHAR(255) etc. #}
                        <input type="text" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>
                    {% endif %}
                </div>
            {% endfor %}
            <!-- END OF CORRECTED RENDERER -->

            <hr>
            <button type="submit" class="btn btn-primary w-100 fs-5">Submit Form</button>
        </form>
    </main>
</body>
</html>
{% comment %} <!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fill Form: {{ form.form_name }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .container { max-width: 700px; background-color: white; padding: 2rem; border-radius: 0.5rem; margin-top: 2rem; box-shadow: 0 0 15px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
    <main class="container">
        <h2 class="mb-4">{{ form.form_name }}</h2>
        <hr>

        <form method="post">
            {% csrf_token %}

            {# This is where we dynamically render the form from JSON #}
            {% for field in form.fields %}
                <div class="mb-3">
                    <label for="{{ field.name|slugify }}" class="form-label fw-bold">{{ field.name }}</label>
                    
                    {% if field.type == "TEXTAREA" %}
                        <textarea name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required></textarea>
                    
                    {% elif field.type == "SELECT" %}
                        <select name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-select" required>
                            <option value="" disabled selected>-- Please choose an option --</option>
                            {% for option in field.options %}
                                <option value="{{ option }}">{{ option }}</option>
                            {% endfor %}
                        </select>
                    
                    {% elif field.type == "RADIO" %}
                        {% for option in field.options %}
                        <div class="form-check">
                        <input class="form-check-input" type="radio" name="{{ field.name }}" id="{{ field.name|slugify }}-{{ forloop.counter }}" value="{{ option }}" required>
                        <label class="form-check-label" for="{{ field.name|slugify }}-{{ forloop.counter }}">
                            {{ option }}
                        </label>
                        </div>
                        {% endfor %}

                    {% elif field.type == "INTEGER" %}
                        <input type="number" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>

                    {% elif field.type == "FLOAT" %}
                        <input type="number" step="any" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>

                    {% elif field.type == "DATE" %}
                        <input type="date" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>

                    {% elif field.type == "EMAIL" %}
                        <input type="email" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>

                    {% else %}
                        <input type="text" name="{{ field.name }}" id="{{ field.name|slugify }}" class="form-control" required>
                    {% endif %}
                </div>
            {% endfor %}

            <hr>
            <button type="submit" class="btn btn-primary w-100 fs-5">Submit Form</button>
        </form>
    </main>
</body>
</html> {% endcomment %}